Function AdvScreen::effectQuake(Reference this, Integer w, Integer h, Integer fWhole, Integer count, Integer time)
	INIT_LOCAL Reference rTarget
	INIT_LOCAL struct Sprite spr
	PUSH_VAR fWhole
	PUSH_VAL Integer 0i
	==
	JUMP_OK _l_28
	PUSH_VAR spr
	PUSH_FIELD sprCg
	POP =
	NOP
	PUSH_VAR spr
	PUSH_VAL Integer 98i
	CALL_METHOD SetTransparency
	NOP
	PUSH_VAR spr
	PUSH_VAL Integer -1i
	CALL_METHOD SetVisible
	NOP
	PUSH_FIELD sprAdvBase
	PUSH_VAL Integer 50i
	PUSH_VAR spr
	CALL_METHOD AddSprite
	NOP
	PUSH_VAR rTarget
	PUSH_VAR spr
	POP =
	NOP
	JUMP _l_32
@_l_28:
	PUSH_VAR rTarget
	PUSH_FIELD sprAdvBase
	POP =
	NOP
@_l_32:
	INIT_LOCAL struct SpriteParam param
	PUSH_VAR rTarget
	PUSH_VAR param
	CALL_METHOD GetParameter
	NOP
	INIT_LOCAL Reference pt
	PUSH_VAR pt
	PUSH_VAR param
	GET_FIELD ptDstPos
	POP =
	NOP
	INIT_LOCAL struct Bezier2D bzCurve1
	INIT_LOCAL struct Bezier2D bzCurve2
	INIT_LOCAL struct Bezier2D bzCurve3
	INIT_LOCAL struct Bezier2D bzCurve4
	PUSH_VAR bzCurve1
	PUSH_VAR pt
	GET_FIELD x
	PUSH_VAL Integer 0i
	+
	PUSH_VAR pt
	GET_FIELD y
	PUSH_VAL Integer 0i
	+
	PUSH_VAR pt
	GET_FIELD x
	PUSH_VAR w
	-
	PUSH_VAR pt
	GET_FIELD y
	PUSH_VAR h
	-
	CALL_METHOD SetLinear
	NOP
	PUSH_VAR bzCurve2
	PUSH_VAR pt
	GET_FIELD x
	PUSH_VAR w
	-
	PUSH_VAR pt
	GET_FIELD y
	PUSH_VAR h
	-
	PUSH_VAR pt
	GET_FIELD x
	PUSH_VAR w
	+
	PUSH_VAR pt
	GET_FIELD y
	PUSH_VAR h
	+
	CALL_METHOD SetLinear
	NOP
	PUSH_VAR bzCurve3
	PUSH_VAR pt
	GET_FIELD x
	PUSH_VAR w
	+
	PUSH_VAR pt
	GET_FIELD y
	PUSH_VAR h
	+
	PUSH_VAR pt
	GET_FIELD x
	PUSH_VAR w
	-
	PUSH_VAR pt
	GET_FIELD y
	PUSH_VAR h
	-
	CALL_METHOD SetLinear
	NOP
	PUSH_VAR bzCurve4
	PUSH_VAR pt
	GET_FIELD x
	PUSH_VAR w
	+
	PUSH_VAR pt
	GET_FIELD y
	PUSH_VAR h
	+
	PUSH_VAR pt
	GET_FIELD x
	PUSH_VAL Integer 0i
	+
	PUSH_VAR pt
	GET_FIELD y
	PUSH_VAL Integer 0i
	+
	CALL_METHOD SetLinear
	NOP
	PUSH_VAR time
	PUSH_VAL Integer 0i
	==
	JUMP_OK _l_131
	PUSH_VAR time
	PUSH_VAL Integer 30i
	POP =
	NOP
@_l_131:
	PUSH_VAR rTarget
	PUSH_VAR bzCurve1
	CALL_METHOD SetBezierCurve
	NOP
	PUSH_VAR rTarget
	PUSH_VAR time
	CALL_METHOD BeginActivation
	NOP
	PUSH_VAR rTarget
	PUSH_VAL Integer 0i
	CALL WaitUntilSpriteActive
	NOP
@_l_143:
	PUSH_VAR count
	PUSH_VAL Integer 0i
	>=
	JUMP_OK _l_184
	PUSH_VAR rTarget
	PUSH_VAR bzCurve2
	CALL_METHOD SetBezierCurve
	NOP
	PUSH_VAR rTarget
	PUSH_VAR time
	PUSH_VAL Integer 2i
	*
	CALL_METHOD BeginActivation
	NOP
	PUSH_VAR rTarget
	PUSH_VAL Integer 0i
	CALL WaitUntilSpriteActive
	NOP
	PUSH_VAR count
	PUSH_VAL Integer 1i
	POP -=
	NOP
	PUSH_VAR count
	PUSH_VAL Integer 0i
	>=
	JUMP_OK _l_183
	PUSH_VAR rTarget
	PUSH_VAR bzCurve3
	CALL_METHOD SetBezierCurve
	NOP
	PUSH_VAR rTarget
	PUSH_VAR time
	PUSH_VAL Integer 2i
	*
	CALL_METHOD BeginActivation
	NOP
	PUSH_VAR rTarget
	PUSH_VAL Integer 0i
	CALL WaitUntilSpriteActive
	NOP
@_l_183:
	JUMP _l_143
@_l_184:
	PUSH_VAR rTarget
	PUSH_VAR bzCurve4
	CALL_METHOD SetBezierCurve
	NOP
	PUSH_VAR rTarget
	PUSH_VAR time
	CALL_METHOD BeginActivation
	NOP
	PUSH_VAR rTarget
	PUSH_VAL Integer 0i
	CALL WaitUntilSpriteActive
	NOP
	PUSH_VAR fWhole
	PUSH_VAL Integer 0i
	==
	JUMP_OK _l_208
	PUSH_VAR spr
	PUSH_VAL Integer 0i
	CALL_METHOD SetVisible
	NOP
	PUSH_FIELD sprAdvBase
	PUSH_VAR spr
	CALL_METHOD DetachSprite
	NOP
@_l_208:
	PUSH_VAL Integer 0i
	Return
EndFunc

