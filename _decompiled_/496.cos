Function Confirm(String str, Integer fYesNo, Reference refSpr, Integer time)
	PUSH_UNK
	PUSH_VAL String ""
	CALL_METHOD SetFocus
	NOP
	CALL IsConfirm
	PUSH_VAL Integer -1i
	==
	JUMP_OK _l_10
	PUSH_VAL Integer 0i
	Return
@_l_10:
	INIT_LOCAL Integer ret
	PUSH_VAL Integer 0i
	POP =
	PUSH_OBJ  22
	PUSH_VAL Integer -1i
	POP =
	NOP
	INIT_LOCAL struct Sprite sprBlack
	INIT_LOCAL struct Sprite sprBase
	INIT_LOCAL struct Sprite sprFrame
	INIT_LOCAL struct MessageSprite msprMessage
	PUSH_VAR sprBlack
	PUSH_VAL Integer 1i
	PUSH_OBJ  2
	GET_FIELD w
	PUSH_OBJ  2
	GET_FIELD h
	CALL_METHOD CreateSprite
	NOP
	PUSH_VAR sprBlack
	PUSH_VAL Integer 0i
	PUSH_VAL Integer 0i
	PUSH_OBJ  2
	GET_FIELD w
	PUSH_OBJ  2
	GET_FIELD h
	CALL IRect
	PUSH_VAL Integer 0i
	PUSH_VAL Integer 0i
	PUSH_VAL Integer 0i
	CALL RGB
	CALL_METHOD FillRect
	NOP
	PUSH_VAR sprBlack
	PUSH_VAL Integer 256i
	CALL_METHOD SetTransparency
	NOP
	PUSH_VAR sprBlack
	PUSH_VAL Integer -1i
	CALL_METHOD SetVisible
	NOP
	PUSH_UNK
	PUSH_VAR sprFrame
	PUSH_VAL String "ID_PAGE_CONFIRM"
	CALL_METHOD CreateFormPage
	NOP
	INIT_LOCAL struct ImageInfo info
	PUSH_VAR info
	PUSH_VAR sprFrame
	CALL_METHOD GetInfo
	POP =
	NOP
	PUSH_VAR fYesNo
	PUSH_VAL Integer -1i
	==
	JUMP_OK _l_67
	JUMP _l_77
@_l_67:
	PUSH_VAR sprFrame
	PUSH_VAL Integer 256i
	PUSH_VAL String "ID_YES"
	CALL_METHOD SetTransparency
	NOP
	PUSH_VAR sprFrame
	PUSH_VAL Integer 256i
	PUSH_VAL String "ID_NO"
	CALL_METHOD SetTransparency
	NOP
@_l_77:
	PUSH_VAR sprFrame
	PUSH_VAL Integer -1i
	CALL_METHOD SetVisible
	NOP
	PUSH_VAR msprMessage
	PUSH_OBJ  2
	GET_FIELD w
	PUSH_VAL Integer 24i
	CALL_METHOD CreateMessage
	NOP
	PUSH_VAR msprMessage
	PUSH_UNK
	PUSH_VAL String "ID_FONT_CONFIRM"
	CALL_METHOD AttachMessageStyle
	NOP
	PUSH_VAR msprMessage
	PUSH_VAL Integer 0i
	PUSH_VAL Integer 0i
	PUSH_VAL Integer 0i
	CALL_METHOD SetDefaultMsgSpeed
	NOP
	PUSH_VAR fYesNo
	PUSH_VAL Integer -1i
	==
	JUMP_OK _l_108
	PUSH_VAR msprMessage
	PUSH_VAL Integer 0i
	PUSH_VAL Integer 30i
	CALL_METHOD MovePosition
	NOP
	JUMP _l_118
@_l_108:
	PUSH_VAR msprMessage
	PUSH_VAL Integer 0i
	PUSH_VAR info
	GET_FIELD nImageHeight
	PUSH_VAL Integer 24i
	-
	PUSH_VAL Integer 2i
	/
	CALL_METHOD MovePosition
	NOP
@_l_118:
	PUSH_VAR msprMessage
	PUSH_VAR str
	CALL_METHOD OutputMessage
	NOP
	PUSH_VAR msprMessage
	PUSH_VAL Integer -1i
	CALL_METHOD SetVisible
	NOP
	PUSH_VAR sprBase
	PUSH_VAL Integer 67108865i
	PUSH_VAR info
	GET_FIELD nImageWidth
	PUSH_VAR info
	GET_FIELD nImageHeight
	CALL_METHOD CreateSprite
	NOP
	PUSH_VAR sprBase
	PUSH_VAL Integer 256i
	CALL_METHOD SetTransparency
	NOP
	PUSH_VAR sprBase
	PUSH_VAL Integer 10i
	PUSH_VAR msprMessage
	CALL_METHOD AddSprite
	NOP
	PUSH_VAR sprBase
	PUSH_VAL Integer 20i
	PUSH_VAR sprFrame
	CALL_METHOD AddSprite
	NOP
	PUSH_VAR sprBase
	PUSH_VAL Integer 0i
	PUSH_OBJ  2
	GET_FIELD h
	PUSH_VAL Integer 2i
	/
	CALL_METHOD MovePosition
	NOP
	INIT_LOCAL struct SpriteParam param
	PUSH_VAR sprBase
	PUSH_VAR param
	CALL_METHOD GetParameter
	NOP
	PUSH_VAR param
	GET_FIELD ptRevCenter
	GET_FIELD y
	PUSH_VAR info
	GET_FIELD nImageHeight
	PUSH_VAL Integer 2i
	/
	POP =
	NOP
	PUSH_VAR sprBase
	PUSH_VAR param
	CALL_METHOD SetParameter
	NOP
	PUSH_VAR sprBase
	PUSH_VAL Integer -1i
	CALL_METHOD SetVisible
	NOP
	PUSH_VAR refSpr
	CALL_METHOD GetType
	PUSH_VAL String "Sprite"
	==
	JUMP_OK _l_254

	INIT_LOCAL struct ImageInfo sprInfo
	PUSH_VAR refSpr
	CALL_METHOD GetInfo
	POP =
	INIT_LOCAL struct SpriteParam param
	PUSH_VAR refSpr
	PUSH_VAR param
	CALL_METHOD GetParameter
	NOP
	PUSH_VAR param
	GET_FIELD ptRevCenter
	GET_FIELD x
	PUSH_VAR sprInfo
	GET_FIELD nImageWidth
	PUSH_VAL Integer 2i
	/
	POP =
	NOP
	PUSH_VAR param
	GET_FIELD ptRevCenter
	GET_FIELD y
	PUSH_VAR sprInfo
	GET_FIELD nImageHeight
	PUSH_VAL Integer 2i
	/
	POP =
	NOP
	PUSH_VAL Integer 80i
	PUSH_VAR sprInfo
	GET_FIELD nImageHeight
	<=
	JUMP_OK _l_232
	PUSH_VAR param
	GET_FIELD rHorzUnit
	PUSH_VAL Real 80d
	PUSH_VAR sprInfo
	GET_FIELD nImageHeight
	/
	POP =
	NOP
	PUSH_VAR param
	GET_FIELD rVertUnit
	PUSH_VAL Real 80d
	PUSH_VAR sprInfo
	GET_FIELD nImageHeight
	/
	POP =
	NOP
@_l_232:
	PUSH_VAR refSpr
	PUSH_VAR param
	CALL_METHOD SetParameter
	NOP
	PUSH_VAR refSpr
	PUSH_VAL Integer 128i
	PUSH_VAR info
	GET_FIELD nImageHeight
	PUSH_VAL Integer 2i
	/
	CALL_METHOD MovePosition
	NOP
	PUSH_VAR refSpr
	PUSH_VAL Integer -1i
	CALL_METHOD SetVisible
	NOP
	PUSH_VAR sprBase
	PUSH_VAL Integer 15i
	PUSH_VAR refSpr
	CALL_METHOD AddSprite
	NOP
	NOP
@_l_254:
	PUSH_UNK
	PUSH_VAL Integer 50200i
	PUSH_VAR sprBase
	CALL_METHOD AddSprite
	NOP
	PUSH_UNK
	PUSH_VAL Integer 50200i
	PUSH_VAR sprBlack
	CALL_METHOD AddSprite
	NOP
	PUSH_UNK
	CALL_METHOD Lock
	NOP
	PUSH_OBJ  5
	GET_FIELD screenEffect
	PUSH_VAL Integer 0i
	==
	JUMP_OK _l_310

	INIT_LOCAL struct Bezier2D bzMag
	PUSH_VAR sprInfo
	PUSH_VAL Real 1d
	PUSH_VAL Real 0d
	PUSH_VAL Real 1d
	PUSH_VAL Real 1d
	CALL_METHOD SetLinear
	NOP
	PUSH_VAR sprInfo
	PUSH_VAL Integer 3i
	PUSH_VAL Integer 0i
	CALL_METHOD SetAcceleration
	NOP
	PUSH_VAR sprBase
	PUSH_VAL Reference ref
	PUSH_VAL Reference ref
	PUSH_VAR sprInfo
	CALL_METHOD SetBezierCurve
	NOP
	PUSH_VAR sprBase
	PUSH_VAL Integer 0i
	CALL_METHOD SetBlendingEnvelope
	NOP
	PUSH_VAR sprBase
	PUSH_VAL Integer 300i
	CALL_METHOD BeginActivation
	NOP
	PUSH_VAR sprBlack
	PUSH_VAL Integer 128i
	CALL_METHOD SetBlendingEnvelope
	NOP
	PUSH_VAR sprBlack
	PUSH_VAL Integer 300i
	CALL_METHOD BeginActivation
	NOP
	NOP
	JUMP _l_318
@_l_310:
	PUSH_VAR sprBase
	PUSH_VAL Integer 0i
	CALL_METHOD SetTransparency
	NOP
	PUSH_VAR sprBlack
	PUSH_VAL Integer 128i
	CALL_METHOD SetTransparency
	NOP
@_l_318:
	PUSH_UNK
	CALL_METHOD Unlock
	NOP
	PUSH_UNK
	CALL_METHOD FlushJoyButtonPushed
	NOP
	PUSH_UNK
	PUSH_VAL Integer -1i
	CALL_METHOD FlushCommandQueue
	NOP
	INIT_LOCAL struct WndSpriteCmd wscmd
	PUSH_VAR fYesNo
	PUSH_VAL Integer -1i
	==
	JUMP_OK _l_381
@_l_333:
	PUSH_VAL Integer -1i
	JUMP_OK _l_380
	PUSH_VAR sprInfo
	PUSH_VAL Integer 33i
	CALL GetCommand
	NOP
	PUSH_VAL Integer 0i
	JUMP_OK _l_342
	JUMP _l_379
@_l_342:
	PUSH_VAR sprInfo
	GET_FIELD strID
	PUSH_VAL String "ID_YES"
	==
	JUMP_OK _l_358
	PUSH_VAR sprFrame
	PUSH_VAL Integer 0i
	PUSH_VAL String "ID_YES"
	CALL_METHOD Enable
	NOP
	PUSH_VAR ret
	PUSH_VAL Integer -1i
	POP =
	NOP
	JUMP _l_380
	JUMP _l_379
@_l_358:
	PUSH_VAR sprInfo
	GET_FIELD strID
	PUSH_VAL String "ID_NO"
	==
	PUSH_UNK
	PUSH_VAL Integer 5i
	CALL_METHOD GetJoyButtonPushed
	PUSH_VAL Integer 0i
	>
	or
	JUMP_OK _l_379
	PUSH_VAR sprFrame
	PUSH_VAL Integer 0i
	PUSH_VAL String "ID_NO"
	CALL_METHOD Enable
	NOP
	PUSH_VAR ret
	PUSH_VAL Integer 0i
	POP =
	NOP
	JUMP _l_380
@_l_379:
	JUMP _l_333
@_l_380:
	JUMP _l_422
@_l_381:
	PUSH_VAR time
	PUSH_VAL Integer 0i
	==
	JUMP_OK _l_389
	PUSH_VAR time
	PUSH_VAL Integer 1000i
	POP =
	NOP
@_l_389:

	INIT_LOCAL Integer startTime
	CALL GetCurrentTime
	POP =
@_l_393:
	PUSH_VAL Integer -1i
	JUMP_OK _l_421
	PUSH_VAR sprInfo
	PUSH_VAL Integer 33i
	CALL GetCommand
	NOP
	PUSH_VAR param
	PUSH_VAR time
	+
	CALL GetCurrentTime
	<=
	JUMP_OK _l_407
	JUMP _l_421
	JUMP _l_420
@_l_407:
	PUSH_UNK
	PUSH_VAL Integer 4i
	CALL_METHOD GetJoyButtonPushed
	PUSH_VAL Integer 0i
	>
	PUSH_UNK
	PUSH_VAL Integer 5i
	CALL_METHOD GetJoyButtonPushed
	PUSH_VAL Integer 0i
	>
	or
	JUMP_OK _l_420
	JUMP _l_421
@_l_420:
	JUMP _l_393
@_l_421:
	NOP
@_l_422:
	PUSH_UNK
	CALL_METHOD Lock
	NOP
	PUSH_OBJ  5
	GET_FIELD screenEffect
	PUSH_VAL Integer 0i
	==
	JUMP_OK _l_454
	PUSH_VAR sprBase
	PUSH_VAL Integer 256i
	CALL_METHOD SetBlendingEnvelope
	NOP
	PUSH_VAR sprBase
	PUSH_VAL Integer 300i
	CALL_METHOD BeginActivation
	NOP
	PUSH_VAR sprBlack
	PUSH_VAL Integer 256i
	CALL_METHOD SetBlendingEnvelope
	NOP
	PUSH_VAR sprBlack
	PUSH_VAL Integer 300i
	CALL_METHOD BeginActivation
	NOP
	PUSH_UNK
	CALL_METHOD Unlock
	NOP
	PUSH_VAR sprBlack
	PUSH_VAL Integer 0i
	CALL WaitUntilSpriteActive
	NOP
	JUMP _l_465
@_l_454:
	PUSH_VAR sprBase
	PUSH_VAL Integer 0i
	CALL_METHOD SetVisible
	NOP
	PUSH_VAR sprBlack
	PUSH_VAL Integer 0i
	CALL_METHOD SetVisible
	NOP
	PUSH_UNK
	CALL_METHOD Unlock
	NOP
@_l_465:
	PUSH_VAR sprBase
	PUSH_VAR msprMessage
	CALL_METHOD DetachSprite
	NOP
	PUSH_VAR sprBase
	PUSH_VAR sprFrame
	CALL_METHOD DetachSprite
	NOP
	PUSH_VAR sprBase
	PUSH_VAR sprBase
	CALL_METHOD DetachSprite
	NOP
	PUSH_VAR refSpr
	CALL_METHOD GetType
	PUSH_VAL String "Sprite"
	==
	JUMP_OK _l_486
	PUSH_VAR sprBase
	PUSH_VAR refSpr
	CALL_METHOD DetachSprite
	NOP
@_l_486:
	PUSH_UNK
	PUSH_VAR sprBlack
	CALL_METHOD DetachSprite
	NOP
	PUSH_OBJ  22
	PUSH_VAL Integer 0i
	POP =
	NOP
	PUSH_UNK
	CALL_METHOD FlushJoyButtonPushed
	NOP
	PUSH_UNK
	PUSH_VAL Integer -1i
	CALL_METHOD FlushCommandQueue
	NOP
	PUSH_VAR ret
	Return
	PUSH_VAL Integer 0i
	Return
	@@Initialize

	Return this
EndFunc

