Function HistoryWindow::create(Reference this)
	INIT_LOCAL Integer i
	PUSH_UNK
	PUSH_FIELD sprFrame
	PUSH_VAL String "ID_PAGE_HISTORY"
	CALL_METHOD CreateFormPage
	NOP
	PUSH_FIELD sprFrame
	PUSH_VAL Integer -1i
	CALL_METHOD SetVisible
	NOP
	INIT_LOCAL struct ImageInfo info
	PUSH_VAR info
	PUSH_FIELD sprFrame
	CALL_METHOD GetInfo
	POP =
	NOP
	PUSH_FIELD sprBase
	PUSH_VAL Integer 67108865i
	PUSH_VAR info
	GET_FIELD nImageWidth
	PUSH_VAR info
	GET_FIELD nImageHeight
	CALL_METHOD CreateSprite
	NOP
	PUSH_FIELD sprBase
	PUSH_VAL Integer 256i
	CALL_METHOD SetTransparency
	NOP
	PUSH_FIELD sprBase
	PUSH_VAL Integer -1i
	CALL_METHOD SetVisible
	NOP
	INIT_LOCAL struct SpriteParam param
	PUSH_FIELD sprBase
	PUSH_VAR param
	CALL_METHOD GetParameter
	NOP
	PUSH_VAR param
	GET_FIELD ptDstPos
	PUSH_VAL Integer 800i
	PUSH_VAL Integer 2i
	/
	PUSH_VAL Integer 600i
	PUSH_VAL Integer 2i
	/
	PUSH_VAR info
	GET_FIELD nImageHeight
	PUSH_VAL Integer 2i
	/
	+
	CALL IPoint
	POP =
	NOP
	PUSH_VAR param
	GET_FIELD ptRevCenter
	PUSH_VAR info
	GET_FIELD nImageWidth
	PUSH_VAL Integer 2i
	/
	PUSH_VAR info
	GET_FIELD nImageHeight
	CALL IPoint
	POP =
	NOP
	PUSH_FIELD sprBase
	PUSH_VAR param
	CALL_METHOD SetParameter
	NOP
	PUSH_UNK
	PUSH_VAL Integer 50250i
	PUSH_FIELD sprBase
	CALL_METHOD AddSprite
	NOP
	PUSH_FIELD sprBase
	PUSH_VAL Integer 50i
	PUSH_FIELD sprFrame
	CALL_METHOD AddSprite
	NOP
	PUSH_VAR i
	PUSH_VAL Integer 0i
	POP =
	NOP
@_l_82:
	PUSH_VAR i
	PUSH_VAL Integer 4i
	<=
	JUMP_OK _l_129
	PUSH_FIELD sprVoice
	PUSH_VAR i
	GET_FIELD_BY_OFFSET
	PUSH_VAL struct Sprite struct
	POP =
	NOP
	PUSH_UNK
	PUSH_FIELD sprVoice
	PUSH_VAR i
	GET_FIELD_BY_OFFSET
	PUSH_VAL String "ID_PAGE_HISTORY_VOICE"
	PUSH_VAL String ""
	PUSH_VAR i
	PUSH_VAL Integer 1i
	+
	POP =
	+
	CALL_METHOD CreateFormPage
	NOP
	PUSH_FIELD sprVoice
	PUSH_VAR i
	GET_FIELD_BY_OFFSET
	PUSH_VAL Integer 256i
	CALL_METHOD SetTransparency
	NOP
	PUSH_FIELD sprVoice
	PUSH_VAR i
	GET_FIELD_BY_OFFSET
	PUSH_VAL Integer -1i
	CALL_METHOD SetVisible
	NOP
	PUSH_FIELD sprBase
	PUSH_VAL Integer 30i
	PUSH_FIELD sprVoice
	PUSH_VAR i
	GET_FIELD_BY_OFFSET
	CALL_METHOD AddSprite
	NOP
	PUSH_VAR i
	PUSH_VAL Integer 1i
	POP +=
	NOP
	JUMP _l_82
@_l_129:
	PUSH_FIELD msprMessage
	PUSH_VAL Integer 680i
	PUSH_VAL Integer 504i
	CALL_METHOD CreateMessage
	NOP
	PUSH_FIELD msprMessage
	PUSH_UNK
	PUSH_VAL String "ID_FONT_MESSAGE"
	CALL_METHOD AttachMessageStyle
	NOP
	PUSH_FIELD msprMessage
	PUSH_VAL Integer 0i
	PUSH_VAL Integer 0i
	PUSH_VAL Integer 0i
	CALL_METHOD SetDefaultMsgSpeed
	NOP
	PUSH_FIELD msprMessage
	PUSH_VAL Integer 14i
	PUSH_VAL Integer 0i
	CALL_METHOD MovePosition
	NOP
	PUSH_FIELD msprMessage
	PUSH_VAL Integer -1i
	CALL_METHOD SetVisible
	NOP
	PUSH_FIELD sprBase
	PUSH_VAL Integer 20i
	PUSH_FIELD msprMessage
	CALL_METHOD AddSprite
	NOP
	PUSH_FIELD index
	PUSH_VAL Integer 0i
	POP =
	NOP
	PUSH_FIELD indexRange
	PUSH_OBJ  4
	GET_FIELD nameLog
	CALL_METHOD num
	PUSH_VAL Integer 4i
	-
	POP =
	NOP
	PUSH_FIELD indexRange
	PUSH_VAL Integer 0i
	<
	JUMP_OK _l_185
	PUSH_FIELD sprFrame
	PUSH_VAL Integer 256i
	PUSH_VAL String "ID_SCROLL"
	CALL_METHOD SetTransparency
	NOP
	PUSH_FIELD indexRange
	PUSH_VAL Integer 0i
	POP =
	NOP
	JUMP _l_195
@_l_185:
	PUSH_FIELD sprFrame
	PUSH_FIELD indexRange
	PUSH_VAL String "ID_SCROLL"
	CALL_METHOD SetVertScrollRange
	NOP
	PUSH_FIELD sprFrame
	PUSH_FIELD indexRange
	PUSH_VAL String "ID_SCROLL"
	CALL_METHOD SetVertScrollPos
	NOP
@_l_195:
	PUSH_FIELD index
	CALL setPage
	NOP
	PUSH_VAL Integer 0i
	Return
EndFunc

