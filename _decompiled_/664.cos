Function PlayMovie(String strFileName, Integer nFlags)
	INIT_LOCAL struct MovieSprite movie
	PUSH_VAR movie
	PUSH_VAR strFileName
	CALL_METHOD OpenMovie
	logic_unk3
	JUMP_OK _l_117

	INIT_LOCAL struct SpriteParam sp
	INIT_LOCAL struct ImageInfo imginf
	PUSH_UNK
	CALL_METHOD Lock
	NOP
	PUSH_UNK
	PUSH_VAL Integer 0i
	PUSH_VAR movie
	CALL_METHOD AddSprite
	NOP
	PUSH_VAR imginf
	PUSH_VAR movie
	CALL_METHOD GetInfo
	POP =
	NOP
	PUSH_VAR movie
	PUSH_VAR sp
	CALL_METHOD GetParameter
	NOP
	PUSH_VAR sp
	GET_FIELD rHorzUnit
	PUSH_VAL Real 0d
	PUSH_VAL Real 800d
	POP =
	PUSH_VAR imginf
	GET_FIELD nImageWidth
	/
	POP =
	NOP
	PUSH_VAR sp
	GET_FIELD rVertUnit
	PUSH_VAL Real 0d
	PUSH_VAL Real 600d
	POP =
	PUSH_VAR imginf
	GET_FIELD nImageHeight
	/
	POP =
	NOP
	PUSH_VAR movie
	PUSH_VAR sp
	CALL_METHOD SetParameter
	NOP
	PUSH_UNK
	CALL_METHOD Unlock
	NOP
	PUSH_UNK
	PUSH_VAL Integer 0i
	CALL_METHOD ShowCursor
	NOP
	INIT_LOCAL Integer nFlags
	PUSH_VAL Integer 1i
	POP =
	PUSH_VAR movie
	PUSH_VAR nFlags
	PUSH_VAL Integer 0i
	CALL_METHOD PlayMovie
	NOP
	INIT_LOCAL struct WndSpriteCmd wscmd
	PUSH_UNK
	CALL_METHOD FlushJoyButtonPushed
	NOP
@_l_69:
	PUSH_VAR movie
	CALL_METHOD IsMoviePlaying
	JUMP_OK _l_93
	PUSH_VAL Integer 100i
	CALL Sleep
	NOP
	PUSH_UNK
	PUSH_VAL Integer 4i
	CALL_METHOD GetJoyButtonPushed
	PUSH_UNK
	PUSH_VAL Integer 5i
	CALL_METHOD GetJoyButtonPushed
	math_UNK2
	JUMP_OK _l_84
	JUMP _l_93
@_l_84:
	PUSH_UNK
	PUSH_VAR wscmd
	PUSH_VAL Integer 100i
	PUSH_VAL Integer 0i
	CALL_METHOD GetCommand
	logic_unk3
	JUMP_OK _l_92
	JUMP _l_93
@_l_92:
	JUMP _l_69
@_l_93:
	PUSH_VAR movie
	CALL_METHOD StopMovie
	NOP
	PUSH_UNK
	CALL_METHOD Lock
	NOP
	PUSH_UNK
	PUSH_VAR movie
	CALL_METHOD DetachSprite
	NOP
	PUSH_UNK
	CALL_METHOD UpdateRect
	NOP
	PUSH_UNK
	CALL_METHOD Unlock
	NOP
	PUSH_UNK
	PUSH_VAL Integer -1i
	CALL_METHOD ShowCursor
	NOP
	PUSH_VAR movie
	CALL_METHOD CloseMovie
	NOP
	NOP
@_l_117:
	PUSH_VAL Integer 0i
	Return
EndFunc

