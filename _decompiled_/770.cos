Function WaitUntilSpriteActive(Reference refSprite, Integer fEnableSkip)
	INIT_LOCAL Integer iCanceled
	PUSH_VAL Integer 0i
	POP =
	PUSH_UNK
	CALL_METHOD FlushJoyButtonPushed
	NOP
@_l_6:
	PUSH_VAR refSprite
	CALL_METHOD IsActivation
	JUMP_OK _l_26
	PUSH_VAR fEnableSkip
	PUSH_UNK
	PUSH_VAL Integer 4i
	CALL_METHOD GetJoyButtonPushed
	PUSH_VAL Integer 0i
	>
	and
	JUMP_OK _l_22
	PUSH_VAR iCanceled
	PUSH_VAL Integer -1i
	POP =
	NOP
	JUMP _l_26
@_l_22:
	PUSH_VAL Integer 33i
	CALL Sleep
	NOP
	JUMP _l_6
@_l_26:
	PUSH_VAR refSprite
	CALL_METHOD FlushActivation
	NOP
	CALL UpdateWindow
	NOP
	PUSH_VAR iCanceled
	Return
	PUSH_VAL Integer 0i
	Return
EndFunc

