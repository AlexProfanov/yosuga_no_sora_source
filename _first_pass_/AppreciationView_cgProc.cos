Function AppreciationView::cgProc(Reference wscmd)
	Integer id
	id := -1
	Array aParam
	PUSH_VAL Integer 0i
	JUMP_OK _l_7
	JUMP _l_143
@_l_7:
	If (wscmd.strFullID.IsMatchUsage("&ID_PAGE_TAG&(<0-9>*)&\\ID_TAG&", aParam) == "")
        Integer tag
        tag := aParam[0]
        If (this.sprTag.IsButtonChecked(tag["ID_PAGE1"]) == -1)
            setPage(tag, 0)
        ElseIf (this.sprTag.IsButtonChecked(tag["ID_PAGE2"]) == -1)
            setPage(tag, 1)
        ElseIf (this.sprTag.IsButtonChecked(tag["ID_PAGE3"]) == -1)
            setPage(tag, 2)
        ElseIf (this.sprTag.IsButtonChecked(tag["ID_REC"]) == -1)
            setPage(tag, 3)
        EndIf
    EndIf (wscmd.strFullID.IsMatchUsage("&ID_PAGE_TAG&(<0-9>*)&\\ID_PAGE&(<0-9>*)", aParam) == "")
        setPage(aParam[0], aParam[1])
    EndIf (wscmd.strFullID.IsMatchUsage("&ID_PAGE_TAG&(<0-9>*)&\\ID_REC&", aParam) == "")
        setPage(aParam[0], 3)
    EndIf (wscmd.strFullID.IsMatchUsage("&ID_CGSEL&(<0-9>*)", aParam) == "")
        setPage(aParam[0], 1)
    Else
        Return 0
    EndIf
@_l_143:
    If (if != -1)
        showCgLoop(this.selTag, this.selPage * 12 + id)
    EndIf
	{PUSH_UNK}.FlushCommandQueue(-1)
	Return -1
EndFunc

